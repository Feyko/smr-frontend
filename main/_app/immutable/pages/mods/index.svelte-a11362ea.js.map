{"version":3,"file":"index.svelte-a11362ea.js","sources":["../../../../../../../src/lib/components/mods/ModGrid.svelte","../../../../../../../src/routes/mods/index.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { operationStore, query } from '@urql/svelte';\n  import { GetModsDocument, ModFields, Order } from '$lib/generated';\n  import ModCard from './ModCard.svelte';\n  import PageControls from '$lib/components/utils/PageControls.svelte';\n  import { get, writable } from 'svelte/store';\n  import { base } from '$app/paths';\n  import Button from '@smui/button';\n  import { Input } from '@smui/textfield';\n  import Paper from '@smui/paper';\n  import Fab from '@smui/fab';\n  import { Icon } from '@smui/common';\n  import { goto } from '$app/navigation';\n  import { page as storePage } from '$app/stores';\n  import { user } from '$lib/stores/user';\n  import FicsitCard from '$lib/components/general/FicsitCard.svelte';\n  import Select, { Option } from '@smui/select';\n  import { browser } from '$app/env';\n  import TagList from '$lib/components/utils/TagList.svelte';\n\n  export let colCount: 4 | 5 = 4;\n  export let newMod = false;\n  export let showSearch = false;\n\n  let search = $storePage.url.searchParams.get('q');\n\n  // TODO Selectable\n  const perPage = 40;\n  let order: Order = Order.Desc;\n  let orderBy: ModFields = ModFields.LastVersionDate;\n\n  const mods = operationStore(GetModsDocument, { offset: 0, limit: perPage, search, order, orderBy });\n\n  const page = writable<number>(parseInt($storePage.url.searchParams.get('p'), 10) || 1);\n  let totalMods: number;\n\n  let searchField = search;\n  $: {\n    let changed = false;\n    if ($mods.variables.search !== search) {\n      changed = true;\n      $mods.variables.search = search;\n    }\n\n    if ($mods.variables.order !== order) {\n      changed = true;\n      $mods.variables.order = order;\n    }\n\n    if ($mods.variables.orderBy !== orderBy && orderBy) {\n      changed = true;\n      $mods.variables.orderBy = orderBy;\n    }\n\n    if (changed) {\n      $mods.reexecute();\n    }\n  }\n\n  let timer: number;\n  $: {\n    clearTimeout(timer);\n    timer = setTimeout(() => {\n      if (searchField && searchField.length > 2) {\n        if ((search === '' || search === null) && searchField !== '' && searchField !== null) {\n          orderBy = ModFields.Search;\n          page.set(1);\n        }\n\n        search = searchField;\n      } else if (searchField === '' || searchField === null) {\n        if (orderBy === ModFields.Search || !orderBy) {\n          orderBy = ModFields.LastVersionDate;\n        }\n\n        search = null;\n      }\n    }, 250) as unknown as number;\n  }\n\n  const updateUrl = () => {\n    if (browser) {\n      const url = new URL(window.location.origin + window.location.pathname);\n      url.searchParams.append('p', get(page).toString());\n      searchField !== '' && searchField !== null && url.searchParams.append('q', searchField);\n      goto(url.toString());\n    }\n  };\n\n  page.subscribe((p) => {\n    $mods.variables.offset = (p - 1) * perPage;\n    $mods.reexecute();\n    updateUrl();\n  });\n\n  $: totalMods = $mods?.data?.getMods?.count || 0;\n\n  query(mods);\n\n  $: gridClasses =\n    colCount == 4\n      ? '3xl:grid-cols-4 2xl:grid-cols-3 lg:grid-cols-2 grid-cols-1'\n      : '3xl:grid-cols-3 2xl:grid-cols-2 grid-cols-1';\n\n  const handleKeyDown = (event: CustomEvent | KeyboardEvent) => {\n    if ((event as KeyboardEvent).key === 'Enter') {\n      updateUrl();\n    }\n  };\n\n  $: orderFields = [\n    ['Name', 'name'],\n    ['Views', 'views'],\n    ['Downloads', 'downloads'],\n    ['Hotness (Views)', 'hotness'],\n    ['Popularity (Downloads)', 'popularity'],\n    ['Creation Date', 'created_at'],\n    ['Last Version', 'last_version_date'],\n    ...(search !== '' && search !== null ? [['Search', 'search']] : [])\n  ];\n</script>\n\n<div class=\"ml-auto flex flex-wrap justify-between items-center mb-5\">\n  {#if newMod && $user !== null}\n    <Button variant=\"outlined\" href=\"{base}/new-mod\">New Mod</Button>\n  {/if}\n\n  {#if showSearch}\n    <div class=\"search-container flex flex-wrap sm:px-4\">\n      <div class=\"mr-3\">\n        <TagList editable={true} />\n      </div>\n\n      <div class=\"mr-3\">\n        <Select bind:value={orderBy} label=\"Order By\">\n          {#each orderFields as orderField}\n            <Option value={orderField[1]}>{orderField[0]}</Option>\n          {/each}\n        </Select>\n      </div>\n      <div class=\"mr-3\">\n        <Select bind:value={order} label=\"Order\">\n          <Option value=\"asc\">Ascending</Option>\n          <Option value=\"desc\">Descending</Option>\n        </Select>\n      </div>\n      <Paper class=\"search-paper mr-3\" elevation={6}>\n        <Icon class=\"material-icons\">search</Icon>\n        <Input bind:value={searchField} on:keypress={handleKeyDown} placeholder=\"Search\" />\n      </Paper>\n      <Fab on:click={() => goto(base + '/mods?q=' + search)} color=\"primary\" mini class=\"solo-fab\" aria-label=\"Search\">\n        <Icon class=\"material-icons\">arrow_forward</Icon>\n      </Fab>\n    </div>\n  {/if}\n\n  <div>\n    <PageControls totalPages={Math.ceil(totalMods / perPage)} currentPage={page} />\n  </div>\n</div>\n\n{#if $mods.fetching}\n  <div class=\"grid {gridClasses} gap-4\">\n    {#each Array(perPage) as _}\n      <FicsitCard fake />\n    {/each}\n  </div>\n{:else if $mods.error}\n  <p>Oh no... {$mods.error.message}</p>\n{:else}\n  <div class=\"grid {gridClasses} gap-4\">\n    {#each $mods.data.getMods.mods as mod}\n      <ModCard {mod} />\n    {/each}\n  </div>\n{/if}\n\n<div class=\"mt-5 ml-auto flex justify-end\">\n  <div>\n    <PageControls totalPages={Math.ceil(totalMods / perPage)} currentPage={page} />\n  </div>\n</div>\n\n<style>\n  .search-container {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    flex-grow: 1;\n  }\n\n  * :global(.search-paper) {\n    display: flex;\n    align-items: center;\n    flex-grow: 1;\n    max-width: 600px;\n    height: 48px;\n  }\n\n  * :global(.search-paper > *) {\n    display: inline-block;\n    margin: 0 12px;\n  }\n</style>\n","<script lang=\"ts\">\n  import ModGrid from '$lib/components/mods/ModGrid.svelte';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n</script>\n\n<svelte:head>\n  <MetaDescriptors description=\"Mods available from the Satisfactory Mod Repository\" title=\"Mods\" />\n</svelte:head>\n\n<ModGrid showSearch={true} newMod={true} colCount={4} />\n"],"names":["base","ctx","insert_hydration","target","div3","anchor","append_hydration","div0","div1","div2","t_value","dirty","set_data","t","value","option_changes","length","i","each_blocks","each_value_1","data","getMods","mods","div","error","message","p","t1","t1_value","each_value","Array","perPage","create_if_block_3","create_if_block_2","totalPages","Math","ceil","fetching","pagecontrols0_changes","pagecontrols1_changes","colCount","$$props","newMod","showSearch","search","$storePage","url","searchParams","get","order","Order","Desc","orderBy","ModFields","LastVersionDate","operationStore","GetModsDocument","offset","limit","page","writable","parseInt","totalMods","searchField","timer","updateUrl","URL","window","location","origin","pathname","append","toString","goto","subscribe","$mods","variables","reexecute","query","handleKeyDown","event","key","click_handler","clearTimeout","$$invalidate","setTimeout","Search","set","changed","set_store_value","count","gridClasses","orderFields"],"mappings":"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"}