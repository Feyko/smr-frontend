import{S as st,i as ot,s as $t,bf as lt,a as I,Z as p,g as A,_ as h,j as v,$ as x,t as g,l as j,m,f as w,a1 as y,aC as ft,al as it,aB as O,aD as ct,k as B,u as H,bg as ut,e as C,aa as _,c as P,d as Z,ab as q,a5 as k,ac as D,q as L,bh as z,aM as mt,b2 as G,bi as J,aH as gt,bj as dt,aR as K,b1 as pt,ad as ht,ae as xt}from"../../chunks/vendor-22698a15.js";import{T as yt,a as wt}from"../../chunks/forms-099cb473.js";import{g as Tt,h as vt,C as bt,i as Nt}from"../../chunks/graphql-32ca0bd6.js";function S(s,t,n){const e=s.slice();return e[21]=t[n],e[22]=t,e[23]=n,e}function _t(s){let t,n;return t=new ut({props:{$$slots:{default:[Bt]},$$scope:{ctx:s}}}),{c(){p(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,r){x(t,e,r),n=!0},p(e,r){const a={};r&16777223&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){n||(m(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){y(t,e)}}}function qt(s){let t,n,e=s[5].error.message+"",r;return{c(){t=C("h1"),n=_("Failed to load tags: "),r=_(e)},l(a){t=P(a,"H1",{});var i=Z(t);n=q(i,"Failed to load tags: "),r=q(i,e),i.forEach(w)},m(a,i){v(a,t,i),k(t,n),k(t,r)},p(a,i){i&32&&e!==(e=a[5].error.message+"")&&D(r,e)},i:L,o:L,d(a){a&&w(t)}}}function Et(s){let t,n;return{c(){t=C("h1"),n=_("Loading tags...")},l(e){t=P(e,"H1",{});var r=Z(t);n=q(r,"Loading tags..."),r.forEach(w)},m(e,r){v(e,t,r),k(t,n)},p:L,i:L,o:L,d(e){e&&w(t)}}}function Lt(s){let t=s[21].name+"",n;return{c(){n=_(t)},l(e){n=q(e,t)},m(e,r){v(e,n,r)},p(e,r){r&1&&t!==(t=e[21].name+"")&&D(n,t)},d(e){e&&w(n)}}}function Ft(s){let t;return{c(){t=_("delete_forever")},l(n){t=q(n,"delete_forever")},m(n,e){v(n,t,e)},d(n){n&&w(t)}}}function Ht(s){let t,n;return t=new K({props:{class:"material-icons",$$slots:{default:[Ft]},$$scope:{ctx:s}}}),{c(){p(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,r){x(t,e,r),n=!0},p(e,r){const a={};r&16777216&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){n||(m(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){y(t,e)}}}function It(s){let t,n;function e(...r){return s[10](s[21],...r)}return t=new pt({props:{slot:"icon",$$slots:{default:[Ht]},$$scope:{ctx:s}}}),t.$on("click",e),{c(){p(t.$$.fragment)},l(r){h(t.$$.fragment,r)},m(r,a){x(t,r,a),n=!0},p(r,a){s=r;const i={};a&16777216&&(i.$$scope={dirty:a,ctx:s}),t.$set(i)},i(r){n||(m(t.$$.fragment,r),n=!0)},o(r){g(t.$$.fragment,r),n=!1},d(r){y(t,r)}}}function At(s){let t;return{c(){t=_("Human-Readable name of the tag that is shown in UI")},l(n){t=q(n,"Human-Readable name of the tag that is shown in UI")},m(n,e){v(n,t,e)},d(n){n&&w(t)}}}function Ot(s){let t,n;return t=new wt({props:{slot:"helper",$$slots:{default:[At]},$$scope:{ctx:s}}}),{c(){p(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,r){x(t,e,r),n=!0},p(e,r){const a={};r&16777216&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){n||(m(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){y(t,e)}}}function kt(s){let t,n,e=s[21],r;function a($){s[11]($,s[21])}const i=()=>s[12](t,e),o=()=>s[12](null,e);function l(){return s[13](s[21])}let d={label:"Tag-Name",input$maxLength:zt,$$slots:{helper:[Ot]},$$scope:{ctx:s}};return s[21].name!==void 0&&(d.value=s[21].name),t=new yt({props:d}),H.push(()=>ht(t,"value",a)),i(),t.$on("change",l),{c(){p(t.$$.fragment)},l($){h(t.$$.fragment,$)},m($,u){x(t,$,u),r=!0},p($,u){s=$,e!==s[21]&&(o(),e=s[21],i());const b={};u&16777216&&(b.$$scope={dirty:u,ctx:s}),!n&&u&1&&(n=!0,b.value=s[21].name,xt(()=>n=!1)),t.$set(b)},i($){r||(m(t.$$.fragment,$),r=!0)},o($){g(t.$$.fragment,$),r=!1},d($){o(),y(t,$)}}}function Dt(s){let t,n,e,r;return t=new J({props:{$$slots:{icon:[It],default:[Lt]},$$scope:{ctx:s}}}),e=new dt({props:{$$slots:{default:[kt]},$$scope:{ctx:s}}}),{c(){p(t.$$.fragment),n=I(),p(e.$$.fragment)},l(a){h(t.$$.fragment,a),n=A(a),h(e.$$.fragment,a)},m(a,i){x(t,a,i),v(a,n,i),x(e,a,i),r=!0},p(a,i){const o={};i&16777217&&(o.$$scope={dirty:i,ctx:a}),t.$set(o);const l={};i&16777221&&(l.$$scope={dirty:i,ctx:a}),e.$set(l)},i(a){r||(m(t.$$.fragment,a),m(e.$$.fragment,a),r=!0)},o(a){g(t.$$.fragment,a),g(e.$$.fragment,a),r=!1},d(a){y(t,a),a&&w(n),y(e,a)}}}function U(s){let t,n=s[21],e;const r=()=>s[14](t,n),a=()=>s[14](null,n);let i={$$slots:{default:[Dt]},$$scope:{ctx:s}};return t=new z({props:i}),r(),{c(){p(t.$$.fragment)},l(o){h(t.$$.fragment,o)},m(o,l){x(t,o,l),e=!0},p(o,l){n!==o[21]&&(a(),n=o[21],r());const d={};l&16777221&&(d.$$scope={dirty:l,ctx:o}),t.$set(d)},i(o){e||(m(t.$$.fragment,o),e=!0)},o(o){g(t.$$.fragment,o),e=!1},d(o){a(),y(t,o)}}}function Mt(s){let t;return{c(){t=_("Add new tag")},l(n){t=q(n,"Add new tag")},m(n,e){v(n,t,e)},d(n){n&&w(t)}}}function Rt(s){let t;return{c(){t=_("add")},l(n){t=q(n,"add")},m(n,e){v(n,t,e)},d(n){n&&w(t)}}}function St(s){let t,n,e,r;return t=new G({props:{$$slots:{default:[Mt]},$$scope:{ctx:s}}}),e=new K({props:{class:"material-icons",$$slots:{default:[Rt]},$$scope:{ctx:s}}}),{c(){p(t.$$.fragment),n=I(),p(e.$$.fragment)},l(a){h(t.$$.fragment,a),n=A(a),h(e.$$.fragment,a)},m(a,i){x(t,a,i),v(a,n,i),x(e,a,i),r=!0},p(a,i){const o={};i&16777216&&(o.$$scope={dirty:i,ctx:a}),t.$set(o);const l={};i&16777216&&(l.$$scope={dirty:i,ctx:a}),e.$set(l)},i(a){r||(m(t.$$.fragment,a),m(e.$$.fragment,a),r=!0)},o(a){g(t.$$.fragment,a),g(e.$$.fragment,a),r=!1},d(a){y(t,a),a&&w(n),y(e,a)}}}function Ut(s){let t,n;return t=new gt({props:{variant:"outlined",$$slots:{default:[St]},$$scope:{ctx:s}}}),t.$on("click",s[7]),{c(){p(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,r){x(t,e,r),n=!0},p(e,r){const a={};r&16777216&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){n||(m(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){y(t,e)}}}function jt(s){let t,n;return t=new J({props:{ripple:!1,$$slots:{default:[Ut]},$$scope:{ctx:s}}}),{c(){p(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,r){x(t,e,r),n=!0},p(e,r){const a={};r&16777216&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){n||(m(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){y(t,e)}}}function Bt(s){let t,n,e,r=s[0],a=[];for(let o=0;o<r.length;o+=1)a[o]=U(S(s,r,o));const i=o=>g(a[o],1,1,()=>{a[o]=null});return n=new z({props:{nonInteractive:!0,$$slots:{default:[jt]},$$scope:{ctx:s}}}),{c(){for(let o=0;o<a.length;o+=1)a[o].c();t=I(),p(n.$$.fragment)},l(o){for(let l=0;l<a.length;l+=1)a[l].l(o);t=A(o),h(n.$$.fragment,o)},m(o,l){for(let d=0;d<a.length;d+=1)a[d].m(o,l);v(o,t,l),x(n,o,l),e=!0},p(o,l){if(l&775){r=o[0];let $;for($=0;$<r.length;$+=1){const u=S(o,r,$);a[$]?(a[$].p(u,l),m(a[$],1)):(a[$]=U(u),a[$].c(),m(a[$],1),a[$].m(t.parentNode,t))}for(B(),$=r.length;$<a.length;$+=1)i($);j()}const d={};l&16777216&&(d.$$scope={dirty:l,ctx:o}),n.$set(d)},i(o){if(!e){for(let l=0;l<r.length;l+=1)m(a[l]);m(n.$$.fragment,o),e=!0}},o(o){a=a.filter(Boolean);for(let l=0;l<a.length;l+=1)g(a[l]);g(n.$$.fragment,o),e=!1},d(o){mt(a,o),o&&w(t),y(n,o)}}}function Ct(s){let t;return{c(){t=_(s[3])},l(n){t=q(n,s[3])},m(n,e){v(n,t,e)},p(n,e){e&8&&D(t,n[3])},d(n){n&&w(t)}}}function Pt(s){let t,n;return t=new G({props:{$$slots:{default:[Ct]},$$scope:{ctx:s}}}),{c(){p(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,r){x(t,e,r),n=!0},p(e,r){const a={};r&16777224&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){n||(m(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){y(t,e)}}}function Zt(s){let t,n,e,r,a;const i=[Et,qt,_t],o=[];function l($,u){return $[5].fetching?0:$[6].error?1:2}t=l(s),n=o[t]=i[t](s);let d={timeoutMs:4e3,$$slots:{default:[Pt]},$$scope:{ctx:s}};return r=new lt({props:d}),s[15](r),{c(){n.c(),e=I(),p(r.$$.fragment)},l($){n.l($),e=A($),h(r.$$.fragment,$)},m($,u){o[t].m($,u),v($,e,u),x(r,$,u),a=!0},p($,[u]){let b=t;t=l($),t===b?o[t].p($,u):(B(),g(o[b],1,1,()=>{o[b]=null}),j(),n=o[t],n?n.p($,u):(n=o[t]=i[t]($),n.c()),m(n,1),n.m(e.parentNode,e));const F={};u&16777224&&(F.$$scope={dirty:u,ctx:$}),r.$set(F)},i($){a||(m(n),m(r.$$.fragment,$),a=!0)},o($){g(n),g(r.$$.fragment,$),a=!1},d($){o[t].d($),$&&w(e),s[15](null),y(r,$)}}}const zt=24;function Gt(s,t,n){let e,r=[];const a={},i={};let o="",l,d=-1;const $=ft(Tt);it(s,$,f=>n(5,e=f));const u=O({query:vt}),b=O({query:bt}),F=O({query:Nt});$.subscribe(()=>{const f=e.data;n(0,r=f&&f.getTags||[])}),ct($);function Q(){if(r.find(f=>f.name=="New Tag"))a[r[r.length-1].id].setOpen(!0),i[r[r.length-1].id].focus();else{const f={id:d--,name:"New Tag"};r.push(f),n(0,r),setTimeout(()=>{a[f.id].setOpen(!0);const c=i[f.id];c.focus(),c.getElement().querySelectorAll("input")[0].select()},0)}}async function M(f){if(f.name=="New Tag")return;let c=!1;if(f.id<0){try{const N=await b({tagName:f.name});N.data&&(f.id=N.data.createTag.id,c=!0)}catch(N){console.log(N)}if(!c){n(3,o=`Failed to create Tag '${f.name}'!`),l.open(),setTimeout(()=>l.close(),2e3);return}}else{try{c=(await F({tagID:f.id,tagName:f.name})).data.updateTag!=null}catch{}if(!c){n(3,o=`Failed to update Tag '${f.name}'!`),l.open(),setTimeout(()=>l.close(),2e3);return}}n(3,o=`Tag '${f.name}' saved!`),l.open(),setTimeout(()=>l.close(),2e3)}async function V(f){if(f.name!="New Tag"){let T=!1;try{T=(await u({tagID:f.id})).data.deleteTag}catch{T=!1}if(!T){n(3,o=`Failed to remove Tag '${f.name}'!`),l.open(),setTimeout(()=>l.close(),2e3);return}}const c=()=>{const T=a[f.id].getElement(),E=T.scrollHeight;T.classList.add("smui-accordion__panel--removed"),T.style.height=E+"px",requestAnimationFrame(()=>T.style.height=0+"px"),T.addEventListener("transitionend",at=>{at.propertyName=="height"&&(T.classList.remove("smui-accordion__panel--removed"),T.style.height="auto",n(0,r=r.filter(rt=>rt.id!=f.id)))})};let N=!1;for(const T in a){const E=a[T];E?.isOpen()&&(E.setOpen(!1),N||E.getElement().addEventListener("SMUIAccordionPanel:closed",()=>{c()},{once:!0}),N=!0)}N||c(),n(3,o=`Tag '${f.name}' removed!`),l.open(),setTimeout(()=>l.close(),2e3)}function R(f,c){f.stopPropagation(),V(c)}const W=(f,c)=>R(c,f);function X(f,c){s.$$.not_equal(c.name,f)&&(c.name=f,n(0,r))}function Y(f,c){H[f?"unshift":"push"](()=>{i[c.id]=f,n(2,i)})}const tt=f=>M(f);function et(f,c){H[f?"unshift":"push"](()=>{a[c.id]=f,n(1,a)})}function nt(f){H[f?"unshift":"push"](()=>{l=f,n(4,l)})}return[r,a,i,o,l,e,$,Q,M,R,W,X,Y,tt,et,nt]}class Vt extends st{constructor(t){super(),ot(this,t,Gt,Zt,$t,{})}}export{Vt as default};
//# sourceMappingURL=tag-manager.svelte-eb6157df.js.map
