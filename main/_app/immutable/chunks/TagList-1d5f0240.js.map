{"version":3,"file":"TagList-1d5f0240.js","sources":["../../../../../../src/lib/components/utils/TagList.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { GetTagsDocument } from '$lib/generated/graphql';\n  import type { Tag } from '$lib/generated/graphql';\n  import Chip, { Set, Text } from '@smui/chips';\n  import MenuSurface from '@smui/menu-surface';\n  import { operationStore, query } from '@urql/svelte';\n  import type { MenuSurfaceComponentDev } from '@smui/menu-surface/src/MenuSurface.types';\n  import Textfield, { Input } from '@smui/textfield';\n  import FloatingLabel from '@smui/floating-label';\n  import type { InputComponentDev } from '@smui/textfield';\n\n  const getAllTags = operationStore(GetTagsDocument);\n\n  export let tags: Tag[] = [];\n  export let editable = false;\n\n  let inputElement: InputComponentDev;\n\n  const shake = false;\n\n  let tagSearch = '';\n\n  $: allTags = $getAllTags.data?.getTags ?? [];\n  $: availableTags = allTags.filter((tag) => !tags.some((t) => t.id == tag.id));\n  $: filteredTagsMatched = availableTags.filter((tag) => tag.name.toLowerCase().includes(tagSearch));\n  $: filteredTagsUnmatched = availableTags.filter((tag) => !filteredTagsMatched.some((t) => t.id == tag.id));\n\n  let surface: MenuSurfaceComponentDev;\n\n  let tagBox: HTMLDivElement;\n\n  let focused = false;\n\n  if (editable) {\n    query(getAllTags);\n  }\n\n  function addTag(newTag: Tag) {\n    if (!tags.find((tag) => tag.id == newTag.id)) {\n      tags = [...tags, newTag];\n    }\n  }\n\n  function deleteTag(tag: Tag) {\n    tags = tags.filter((v) => v != tag);\n  }\n\n  function onFocusLost() {\n    setTimeout(() => {\n      if (!tagBox.contains(document.activeElement)) {\n        surface.setOpen(false);\n      }\n    }, 200);\n  }\n</script>\n\n<div class=\"tagHolder\" on:focusin={() => (focused = true)} on:focusout={() => (focused = false)}>\n  {#if !editable}\n    {#if tags.length > 0}\n      <div class=\"flex flex-row flex-wrap text-sm gap-1\">\n        {#each tags as tag}\n          <div class=\"text-neutral-300 lowercase\">\n            <span class=\"text-orange-500\">#</span>{tag.name}\n          </div>\n        {/each}\n      </div>\n    {/if}\n  {:else}\n    <div bind:this={tagBox} on:focusin={() => surface.setOpen(true)} on:focusout={onFocusLost}>\n      <Textfield class=\"tags\" bind:input={inputElement} style=\"z-index: 9999\">\n        <FloatingLabel\n          class=\"pb-2\"\n          for=\"input-manual-a\"\n          slot=\"label\"\n          floatAbove={!!tagSearch || focused || tags.length > 0}>\n          Tags\n        </FloatingLabel>\n        <div class=\"flex flex-row flex-wrap text-sm gap-1 mr-2\">\n          {#each tags as tag}\n            <div class=\"text-neutral-300 flex removable-tag\">\n              <span class=\"hashtag text-orange-500\">#</span>\n              <span class=\"cancel\">\n                <i class=\"material-icons mdc-chip__icon mdc-chip__icon--trailing\" on:click={() => deleteTag(tag)}\n                  >cancel</i>\n              </span>\n              <p>{tag.name}</p>\n            </div>\n          {/each}\n        </div>\n        <div id=\"newTagContainer\" class=\"text-neutral-300 flex\">\n          <Input\n            id=\"input-manual-a\"\n            spellcheck=\"false\"\n            autocomplete=\"off\"\n            class=\"addTag inline text-sm text-neutral-300 {shake ? 'shake' : ''}\"\n            style=\"height: initial\"\n            bind:this={inputElement}\n            bind:value={tagSearch} />\n        </div>\n      </Textfield>\n      <MenuSurface bind:this={surface} managed={true} anchorCorner=\"BOTTOM_LEFT\" on:click={() => inputElement.focus()}>\n        <div style=\"margin: 1rem\">\n          <h1>Available Tags</h1>\n          {#if filteredTagsMatched.length > 0}\n            <div class=\"flex flex-nowrap m-1\">\n              <Set chips={filteredTagsMatched} let:chip key={(tag) => tag.name}>\n                <Chip {chip} on:SMUIChip:interaction={() => addTag(chip)}>\n                  <Text>{chip.name}</Text>\n                </Chip>\n              </Set>\n            </div>\n          {/if}\n          {#if filteredTagsUnmatched.length > 0}\n            <div class=\"flex flex-nowrap m-1\">\n              <Set class=\"unmatched-tag\" chips={filteredTagsUnmatched} let:chip key={(tag) => tag.name}>\n                <Chip {chip} on:SMUIChip:interaction={() => addTag(chip)}>\n                  <Text>{chip.name}</Text>\n                </Chip>\n              </Set>\n            </div>\n          {/if}\n        </div>\n      </MenuSurface>\n    </div>\n  {/if}\n</div>\n\n<style lang=\"scss\">\n  .removable-tag {\n    .cancel {\n      display: none;\n      cursor: pointer;\n\n      i {\n        padding: 0;\n        margin: 0;\n      }\n    }\n\n    &:hover {\n      .hashtag {\n        display: none;\n      }\n\n      .cancel {\n        display: initial;\n      }\n    }\n  }\n\n  :global(.tags) {\n    overflow-y: visible;\n  }\n\n  .tagHolder {\n    min-width: 100px;\n    max-width: 400px;\n    overflow-y: visible;\n\n    /* width */\n    ::-webkit-scrollbar {\n      width: 10px;\n    }\n\n    /* Track */\n    ::-webkit-scrollbar-track {\n      background: #f1f1f1;\n    }\n\n    /* Handle */\n    ::-webkit-scrollbar-thumb {\n      background: #888;\n    }\n\n    /* Handle on hover */\n    ::-webkit-scrollbar-thumb:hover {\n      background: #555;\n    }\n  }\n</style>\n"],"names":["ctx","insert_hydration","target","div","anchor","length","create_if_block_1","t4_value","name","append_hydration","span0","span1","i","p","dirty","set_data","t4","div0","div1","floatAbove","floatinglabel_changes","t_value","t","create_if_block_3","create_if_block_2","h1","t1_value","span","t1","tag","getAllTags","operationStore","GetTagsDocument","tags","$$props","editable","inputElement","tagSearch","surface","tagBox","focused","query","newTag","find","id","filter","v","setTimeout","contains","document","activeElement","setOpen","click_handler","deleteTag","$$value","value","SMUIChip_interaction_handler","chip","addTag","SMUIChip_interaction_handler_1","click_handler_1","focus","focusin_handler_1","$$invalidate","focusout_handler","allTags","$getAllTags","data","getTags","availableTags","some","filteredTagsMatched","toLowerCase","includes","filteredTagsUnmatched"],"mappings":"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"}